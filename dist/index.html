<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Viiibe ‚Äì Connect</title>
    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Lato:wght@400;700&family=Playfair+Display:wght@400;700&family=Roboto:wght@400;500;700&family=Space+Mono:wght@400;700&display=swap"
        rel="stylesheet">
  <script type="module" crossorigin>(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const e of s)if(e.type==="childList")for(const o of e.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const e={};return s.integrity&&(e.integrity=s.integrity),s.referrerPolicy&&(e.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?e.credentials="include":s.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function r(s){if(s.ep)return;s.ep=!0;const e=n(s);fetch(s.href,e)}})();const H={auth:document.getElementById("view-auth"),authorization:document.getElementById("view-authorization"),search:document.getElementById("view-search"),loading:document.getElementById("view-loading"),generating:document.getElementById("view-generating"),moodboard:document.getElementById("view-moodboard"),details:document.getElementById("view-details")},U=document.getElementById("view-wrapper"),y={moodboard:document.getElementById("tab-moodboard"),colors:document.getElementById("tab-colors"),typography:document.getElementById("tab-typography"),layout:document.getElementById("tab-layout")},x={moodboard:document.getElementById("moodboardGrid"),colors:document.getElementById("section-colors"),typography:document.getElementById("section-typography"),layout:document.getElementById("section-layout")};function v(t){const a=["auth","authorization","search","loading","generating"].includes(t);U?.classList.toggle("centered",a),Object.values(H).forEach(n=>n?.classList.remove("active")),H[t]?.classList.add("active")}function M(t,a,n){n/=100;const r=a*Math.min(n,1-n)/100,s=e=>{const o=(e+t/30)%12,i=n-r*Math.max(Math.min(o-3,9-o,1),-1);return Math.round(255*i).toString(16).padStart(2,"0")};return`#${s(0)}${s(8)}${s(4)}`.toUpperCase()}function j(t,a,n){t/=255,a/=255,n/=255;const r=Math.max(t,a,n),s=Math.min(t,a,n);let e=0,o,i=(r+s)/2;if(r===s)e=o=0;else{const g=r-s;switch(o=i>.5?g/(2-r-s):g/(r+s),r){case t:e=(a-n)/g+(a<n?6:0);break;case a:e=(n-t)/g+2;break;case n:e=(t-a)/g+4;break}e/=6}return[e*360,o*100,i*100]}function W(t){const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:{r:0,g:0,b:0}}async function F(t){const a=Math.min(t.length,6),n=[];for(let d=0;d<a;d++){const m=t[d];if(m.src){const b=await G(m);n.push(...b)}}if(n.length===0)return[];const r=[];n.forEach(d=>{let m=r.find(b=>Math.abs(b.h-d.h)<15);m?(m.pixels.push(d),m.weight+=d.s>30?3:1):r.push({h:d.h,pixels:[d],weight:1})}),r.sort((d,m)=>m.weight-d.weight);let s=r.find(d=>d.pixels.some(m=>m.s>20))||r[0],e=s?s.pixels.reduce((d,m)=>m.s-Math.abs(m.l-50)*.5>d.s-Math.abs(d.l-50)*.5?m:d):{h:200,s:0,l:50};const o=M(e.h,e.s,e.l);let i=r.find(d=>Math.abs(d.h-e.h)>40&&d.pixels.some(m=>m.s>30)),g,c;if(i){const d=i.pixels.reduce((m,b)=>b.s>m.s?b:m);g=M(d.h,d.s,d.l),c=`Accent-Context-${Math.round(d.h)}`}else g=M((e.h+180)%360,85,60),c="Accent-Pop";const h=M((e.h+25)%360,Math.max(10,e.s-20),Math.min(90,e.l+15));return[{role:"Primary",hex:o,primitive:`Brand-${Math.round(e.h)}`},{role:"Secondary",hex:h,primitive:"Brand-Alt"},{role:"Accent",hex:g,primitive:c},{role:"Background",hex:"#FFFFFF",primitive:"Base-White"},{role:"Foreground",hex:"#111111",primitive:"Base-Black"},{role:"Neutral",hex:M(e.h,5,50),primitive:"Neutral-500"},{role:"Border",hex:M(e.h,5,90),primitive:"Neutral-200"},{role:"Success",hex:M(140,70,45),primitive:"Green"},{role:"Warning",hex:M(35,90,55),primitive:"Amber"},{role:"Error",hex:M(0,80,55),primitive:"Red"}]}async function X(){const t=document.getElementById("paletteGrid"),a=document.getElementById("sourceImagesGrid"),n=document.querySelectorAll(".pin-image");if(!t)return;if(n.length===0){t.innerHTML='<p style="grid-column:1/-1; text-align:center; color:#999;">Add images first.</p>',a&&(a.innerHTML="");return}t.innerHTML='<p style="grid-column:1/-1; text-align:center; color:#999;">Analyzing vibes...</p>',a&&(a.innerHTML="");const r=Math.min(n.length,6);if(a)for(let e=0;e<r;e++){const o=n[e];if(o.src){const i=document.createElement("img");i.src=o.src,i.className="source-thumb",a.appendChild(i)}}const s=await F(n);V(s)}function G(t){return new Promise(a=>{if(!t.src){console.log("üé® Image has no src"),a([]);return}const n=document.createElement("canvas"),r=n.getContext("2d");if(!r)return console.log("üé® Could not get canvas context"),a([]);n.width=50,n.height=50;const s=new Image;s.crossOrigin="Anonymous",s.onload=()=>{try{r.drawImage(s,0,0,50,50);const e=r.getImageData(0,0,50,50).data,o=[];for(let i=0;i<e.length;i+=16){const[g,c,h]=j(e[i],e[i+1],e[i+2]);h>5&&h<98&&o.push({h:g,s:c,l:h})}a(o)}catch(e){console.error("üé® Canvas error:",e),a([])}},s.onerror=e=>{console.error("üé® Image load error:",e),a([])},s.src=t.src})}function V(t){const a=document.getElementById("paletteGrid");a&&(a.innerHTML="",t.forEach(n=>{const r=document.createElement("div");r.className="role-card";const s=W(n.hex),o=(s.r*299+s.g*587+s.b*114)/1e3>=128?"#000":"#fff";r.innerHTML=`<div class="role-preview" style="background-color:${n.hex}"><div class="contrast-dot" style="background-color:${o}"></div></div><div class="role-info"><span class="role-name">${n.role}</span><span class="role-hex">${n.hex}</span><span class="role-primitive">${n.primitive}</span></div>`,a.appendChild(r)}))}const _={red:{hMin:330,hMax:20},blue:{hMin:190,hMax:260},green:{hMin:70,hMax:160},yellow:{hMin:40,hMax:70},orange:{hMin:20,hMax:40},purple:{hMin:260,hMax:310},pink:{hMin:310,hMax:330},cyan:{hMin:160,hMax:190},black:{lMax:25},white:{lMin:80},gray:{sMax:15},dark:{lMax:30},light:{lMin:70}};async function K(t,a){const n=_[a.toLowerCase()];if(!n)return 0;const r=await G(t);if(r.length===0)return 0;let s=0,e=0;return r.forEach(o=>{let i=!1;const g=o.s/100*(1-Math.abs(o.l-50)/50);n.lMax!==void 0?o.l<=n.lMax&&(i=!0):n.lMin!==void 0?o.l>=n.lMin&&(i=!0):n.sMax!==void 0?o.s<=n.sMax&&(i=!0):o.s>15&&o.l>10&&o.l<90&&(n.hMin>n.hMax?(o.h>=n.hMin||o.h<=n.hMax)&&(i=!0):o.h>=n.hMin&&o.h<=n.hMax&&(i=!0)),i&&(s+=g),e+=g}),e>0?s/e:0}function J(){const t=document.getElementById("typographyContent"),n=(document.getElementById("searchInput")?.value||"").toLowerCase();if(!t||t.children.length>1&&!t.innerHTML.includes("Analyzing"))return;t.innerHTML="";const r={modern:{head:{family:"Inter",weight:"700"},body:{family:"Inter",weight:"400"}},elegant:{name:"Editorial Serif",head:{family:"Playfair Display",weight:"700"},body:{family:"Lato",weight:"400"}},tech:{name:"Tech Mono",head:{family:"Space Mono",weight:"700"},body:{family:"Roboto",weight:"400"}},corporate:{name:"Clean Corp",head:{family:"Roboto",weight:"700"},body:{family:"Roboto",weight:"400"}}},s={majorThird:{name:"Major Third",ratio:"1.250"},minorThird:{name:"Minor Third",ratio:"1.200"},perfectFourth:{name:"Perfect Fourth",ratio:"1.333"}};let e=r.modern,o=s.majorThird,i="Balanced contrast.";n.match(/fashion|wedding|luxury|art/)?(e=r.elegant,o=s.perfectFourth,i="High contrast."):n.match(/dashboard|data|crypto|future/)?(e=r.tech,o=s.minorThird,i="Tight hierarchy."):n.match(/bank|corporate|law|finance/)&&(e=r.corporate,o=s.majorThird,i="Standard ratio.");const g=[{role:"Display 3XL",size:"72px",lh:"120%",ls:"-0.02em",font:e.head,weight:e.head.weight,text:"The quick brown fox"},{role:"Display 2XL",size:"56px",lh:"120%",ls:"-0.02em",font:e.head,weight:e.head.weight,text:"The quick brown fox"},{role:"Heading XL",size:"48px",lh:"120%",ls:"-0.02em",font:e.head,weight:e.head.weight,text:"The quick brown fox"},{role:"Heading L",size:"36px",lh:"120%",ls:"-0.02em",font:e.head,weight:e.head.weight,text:"The quick brown fox"},{role:"Heading M",size:"30px",lh:"120%",ls:"-0.02em",font:e.head,weight:e.head.weight,text:"The quick brown fox"},{role:"Heading S",size:"24px",lh:"120%",ls:"-0.02em",font:e.head,weight:e.head.weight,text:"The quick brown fox"},{role:"Heading XS",size:"20px",lh:"150%",ls:"-0.015em",font:e.head,weight:e.head.weight,text:"The quick brown fox"},{role:"Heading 2XS",size:"18px",lh:"150%",ls:"-0.015em",font:e.head,weight:e.head.weight,text:"The quick brown fox"},{role:"Heading 3XS",size:"16px",lh:"150%",ls:"-0.015em",font:e.head,weight:e.head.weight,text:"The quick brown fox"},{isDivider:!0,label:"Body & Paragraphs",role:"",size:"",lh:"",ls:"",font:{family:""},weight:"",text:""},{role:"Body XL",size:"20px",lh:"150%",ls:"-0.015em",font:e.body,weight:e.body.weight,text:"Lorum ipsum dolor sit amet."},{role:"Body L",size:"18px",lh:"150%",ls:"-0.012em",font:e.body,weight:e.body.weight,text:"Lorum ipsum dolor sit amet."},{role:"Body M",size:"16px",lh:"150%",ls:"-0.01em",font:e.body,weight:e.body.weight,text:"Lorum ipsum dolor sit amet."},{role:"Body S",size:"14px",lh:"150%",ls:"-0.005em",font:e.body,weight:400,text:"Metadata info label"}];let c="";g.forEach(h=>{h.isDivider?c+=`<h4 style="font-size:10px; font-weight:600; text-transform:uppercase; color:#bbb; margin:32px 0 8px 0; letter-spacing:1px;">${h.label}</h4>`:c+=`<div class="scale-item"><div class="scale-meta"><span class="scale-role">${h.role}</span><span class="scale-specs">${h.size} / ${h.lh}</span></div><div class="scale-preview" style="font-family:'${h.font.family}'; font-weight:${h.weight}; font-size:${h.size}; line-height:${h.lh}; letter-spacing:${h.ls};">${h.text}</div></div>`}),t.innerHTML=`<div class="font-pair-card" style="margin-bottom:24px; display:grid; grid-template-columns:1fr 1fr 1.3fr; gap:16px; align-items:start; border-top:1px solid #E0E0E0; padding-top:16px;"><div class="font-preview-box"><span class="font-label">Heading</span><div class="font-name" style="font-family:'${e.head.family}'; font-size:13px; font-weight:600; color:#000;">${e.head.family}</div></div><div class="font-preview-box" style="border-left:1px solid #eee; padding-left:16px;"><span class="font-label">Body</span><div class="font-name" style="font-family:'${e.body.family}'; font-size:13px; font-weight:600; color:#000;">${e.body.family}</div></div><div class="font-preview-box" style="border-left:1px solid #eee; padding-left:16px;"><span class="font-label">Scale System</span><div style="font-size:13px; font-weight:600; color:#000;">${o.name} (${o.ratio})</div><div style="font-size:11px; color:#888; line-height:1.3; margin-top:2px;">${i}</div></div></div><div class="scale-list">${c}</div>`}function T(t){[y.moodboard,y.colors,y.typography,y.layout].forEach(a=>a?.classList.remove("active")),[x.moodboard,x.colors,x.typography,x.layout].forEach(a=>a&&(a.style.display="none")),t==="moodboard"?(y.moodboard?.classList.add("active"),x.moodboard&&(x.moodboard.style.display="block")):t==="colors"?(y.colors?.classList.add("active"),x.colors&&(x.colors.style.display="block"),X()):t==="typography"?(y.typography?.classList.add("active"),x.typography&&(x.typography.style.display="block"),J()):t==="layout"&&(y.layout?.classList.add("active"),x.layout&&(x.style.display="block"))}let L=0;const Q=500;let $=0,k=[],S=!1;function B(t){t<=L||(k.includes(t)||(k.push(t),k.sort((a,n)=>a-n)),N())}function N(){if(k.length===0||S)return;const t=k[0];if(t!==L+1)return;S=!0;const n=Date.now()-$,r=Math.max(0,Q-n);setTimeout(()=>{const e=document.querySelectorAll(".progress-item")[t-1];if(!e){S=!1;return}e.classList.add("active"),setTimeout(()=>{const o=e.querySelector(".checkbox");o&&(o.textContent="‚úì"),e.classList.remove("active"),e.classList.add("completed"),L=t,$=Date.now(),k.shift(),S=!1,t===7?setTimeout(()=>{v("moodboard"),T("moodboard")},2e3):N()},200)},r)}function Y(){L=0,$=Date.now(),k=[],S=!1,document.querySelectorAll(".progress-item").forEach(a=>{a.classList.remove("active","completed");const n=a.querySelector(".checkbox");n&&(n.textContent="‚òê")})}function D(t){const a=(t||"").trim();if(!a)return;Y(),v("loading"),B(1);const n=document.getElementById("moodboardGrid");n&&(n.innerHTML="",n.style.display="block"),parent.postMessage({pluginMessage:{type:"smart-search",query:a}},"*")}async function Z(t){const a=document.getElementById("moodboardGrid");if(!a)return;const n=Array.from(a.querySelectorAll(".pin-image"));let r=0;const s=async()=>{const e=n.filter(o=>o.src&&o.src.length>0);if(e.length>n.length*.5||r>10){console.log(`üé® Starting visual analysis for ${t} on ${e.length} images`);const o=await Promise.all(n.map(async c=>{const h=c.closest(".pin-container");if(!c.src)return{container:h,score:-1,url:""};const d=await K(c,t),m=c.getAttribute("data-url")||"";return{container:h,score:d,url:m}}));o.sort((c,h)=>h.score-c.score);let i=0;const g=[];o.forEach(c=>{c.container&&(c.score>.15?(a.appendChild(c.container),g.push(c.url),i++):c.container.remove())}),window.postMessage({type:"update-lightbox-urls",urls:g},"*"),console.log("üé® Visual sort complete. Visible:",i),B(6),B(7)}else r++,setTimeout(s,500)};setTimeout(s,1e3)}let C=!1;function ee(){if(C){console.log("Auth already in progress, skipping...");return}C=!0;const t=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);console.log("Starting auth flow with sessionId:",t),v("authorization"),parent.postMessage({pluginMessage:{type:"connect-pinterest",sessionId:t}},"*"),te(t)}function te(t){const a=setInterval(async()=>{try{const r=await(await fetch(`https://viiibe-backend-hce5.vercel.app/api/check-auth?state=${t}`)).json();console.log("Polling response:",r),r.ready&&r.token&&(clearInterval(a),C=!1,parent.postMessage({pluginMessage:{type:"token-received",token:r.token}},"*"),console.log("Auth successful! Token received."))}catch(n){console.error("Polling error:",n)}},2e3);setTimeout(()=>{clearInterval(a),C=!1,console.log("Polling timeout")},3e5)}function oe(){const t=document.getElementById("styleGuideDrawer"),a=document.getElementById("drawerBackdrop");t&&a&&(a.classList.add("active"),t.classList.add("active"))}function A(){const t=document.getElementById("styleGuideDrawer"),a=document.getElementById("drawerBackdrop");t&&a&&(a.classList.remove("active"),t.classList.remove("active"))}function ne(){return{downloadMoodboard:document.getElementById("toggle-moodboard")?.checked||!1,downloadColorPalette:document.getElementById("toggle-palette")?.checked||!1,downloadTypeScale:document.getElementById("toggle-typography")?.checked||!1,createFigmaStyles:document.getElementById("toggle-styles")?.checked||!1,createFigmaVariables:document.getElementById("toggle-variables")?.checked||!1,createBasicComponents:!1}}async function ae(){const t=document.querySelectorAll(".pin-image");console.log("üé® [collectAllData] Found image elements:",t.length);const a=[];t.forEach(o=>{if(o.src&&o.src.startsWith("blob:")){const i=o.getAttribute("data-url"),g=fetch(o.src).then(c=>c.arrayBuffer()).then(c=>({url:i,bytes:Array.from(new Uint8Array(c)),width:o.naturalWidth,height:o.naturalHeight}));a.push(g)}});const n=await Promise.all(a);let r=[];if(t.length>0)try{console.log("üé® [collectAllData] Calculating palette..."),r=await F(t),console.log("üé® [collectAllData] Calculated colors:",r.length)}catch(o){console.error("üé® [collectAllData] Error calculating palette:",o)}else console.log("üé® [collectAllData] No images found for palette extraction");const s=[];return document.querySelectorAll(".scale-item").forEach(o=>{const i=o.querySelector(".scale-role")?.textContent,g=o.querySelector(".scale-preview");if(i&&g){const c=window.getComputedStyle(g),h=c.fontSize,d=c.fontFamily,m=c.fontWeight,b=g.textContent;s.push({role:i,size:parseInt(h),font:{family:d.replace(/['"]/g,"")},weight:m,text:b})}}),{images:n,colors:r,typography:s}}document.addEventListener("DOMContentLoaded",function(){parent.postMessage({pluginMessage:{type:"check-auth-status"}},"*"),y.moodboard&&(y.moodboard.onclick=()=>T("moodboard")),y.colors&&(y.colors.onclick=()=>T("colors")),y.typography&&(y.typography.onclick=()=>T("typography")),y.layout&&(y.layout.onclick=()=>T("layout"));const t=document.getElementById("searchInput"),a=document.getElementById("createMoodboardButton");document.querySelectorAll(".chip").forEach(u=>{u.onclick=()=>{t&&(t.value=u.textContent)}}),a&&(a.onclick=()=>D(t?t.value:"")),t&&(t.onkeydown=u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),D(t.value))});const n=document.getElementById("connectButton"),r=document.getElementById("confirmButton");n&&(n.onclick=()=>{ee()}),r&&(r.onclick=()=>{const u=document.getElementById("tokenInput").value;u&&(parent.postMessage({pluginMessage:{type:"token-received",token:u}},"*"),setTimeout(()=>v("search"),500))});const s=document.getElementById("backButton");s&&(s.onclick=()=>{t&&(t.value=""),v("search")});const e=document.getElementById("searchTermsBar");e&&(e.onclick=()=>{const l=document.getElementById("searchTermsDisplay")?.getAttribute("data-original-query")||"";t&&l&&(t.value=l),v("search")});let o=[],i=-1;const g=document.getElementById("detailsImage");window.onmessage=u=>{const l=u?.data?.pluginMessage;if(l){if(l.type==="show-view"&&(console.log("üì® Received show-view message:",l.view),l.view!=="moodboard"?(console.log("‚úÖ Showing view:",l.view),v(l.view)):console.log("‚è∏Ô∏è Skipping immediate moodboard view (handled by progress)"),l.view==="moodboard"&&l.data)){o=[];const p=document.getElementById("moodboardGrid"),f=document.getElementById("searchTermsDisplay");if(f&&l.data.category){f.setAttribute("data-original-query",l.data.category);const w=l.data.category,I=["minimalist","landing page","red","modern","dashboard","mobile app","ecommerce","saas","portfolio","blog","dark","light","bold","clean","vibrant"];let E=w;I.forEach(O=>{const R=new RegExp(`\\b(${O})\\b`,"gi");E=E.replace(R,"<strong>$1</strong>")}),f.innerHTML=E}p&&(p.innerHTML="",l.data.pins&&l.data.pins.length>0?(l.data.pins.forEach(w=>{const I=w.fullsizeUrl||w.thumbnailUrl;if(!I)return;o.push(I);const E=document.createElement("div");E.className="pin-container",E.innerHTML=`<img class="pin-image" data-url="${I}" src="" crossOrigin="Anonymous"/><div class="pin-overlay"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg></div>`,E.querySelector(".pin-overlay").onclick=()=>{i=o.indexOf(I),v("details"),g.src="",parent.postMessage({pluginMessage:{type:"fetch-image",url:I,target:"lightbox"}},"*")},p.appendChild(E),parent.postMessage({pluginMessage:{type:"fetch-image",url:I,target:"grid"}},"*")}),B(4),l.data.intent&&l.data.intent.colors&&l.data.intent.colors.length>0?(B(5),Z(l.data.intent.colors[0])):(B(5),B(6),B(7))):p.innerHTML='<p style="text-align:center; width:100%;">No pins found.</p>')}if(l.type==="show-view"&&l.view==="moodboard")setTimeout(()=>{const p=document.querySelector(".fab");p&&(p.onclick=()=>{oe()})},50);else if(l.type==="open-auth-window")window.open(l.url);else if(l.type==="image-loaded"){const p=URL.createObjectURL(new Blob([l.imageBytes]));if(l.target==="lightbox")g.src=p;else{const f=document.querySelector(`img[data-url="${l.url}"]`);f&&(f.src=p)}}else l.type==="progress-update"&&B(l.step)}},window.addEventListener("message",u=>{u.data.type==="update-lightbox-urls"&&(o=u.data.urls,console.log("üé® Lightbox URLs updated. New count:",o.length),i>=o.length&&(i=0))});function c(){const u=document.getElementById("moodboardGrid");if(!u)return;const l=u.querySelectorAll("img"),p=Array.from(l).map(f=>f.complete?Promise.resolve():new Promise(w=>{f.onload=()=>w(),f.onerror=()=>w()}));Promise.all(p).then(()=>{const f=l.length;let w=3;f<=2?w=1:f<=5?w=2:w=3,u.style.columnCount="1",setTimeout(()=>{u.style.columnCount=String(w)},50)})}const h=document.getElementById("detailsCloseBtn");h&&(h.onclick=()=>{v("moodboard"),setTimeout(()=>{c()},100)});const d=document.getElementById("detailsNextBtn");d&&(d.onclick=()=>{i=(i+1)%o.length,g.src="",parent.postMessage({pluginMessage:{type:"fetch-image",url:o[i],target:"lightbox"}},"*")});const m=document.getElementById("detailsPrevBtn");m&&(m.onclick=()=>{i=(i-1+o.length)%o.length,g.src="",parent.postMessage({pluginMessage:{type:"fetch-image",url:o[i],target:"lightbox"}},"*")});const b=document.getElementById("detailsDeleteBtn");b&&(b.onclick=()=>{if(i>-1&&o[i]){const u=o[i],l=document.querySelectorAll(".pin-container");let p=null;l.forEach(f=>{const w=f.querySelector("img[data-url]");w&&w.dataset.url===u&&(p=f)}),p&&p.remove(),o.splice(i,1),o.length===0?v("moodboard"):(i>=o.length&&(i=0),g.src="",parent.postMessage({pluginMessage:{type:"fetch-image",url:o[i],target:"lightbox"}},"*"))}});const P=document.getElementById("drawerCloseBtn"),q=document.getElementById("drawerBackdrop"),z=document.getElementById("generateStyleGuideBtn");P&&(P.onclick=()=>A()),q&&(q.onclick=()=>A()),z&&(z.onclick=async()=>{const u=ne();console.log("üé® Style guide configuration:",u),A(),v("generating"),console.log("üé® Collecting style guide data...");const l=await ae();console.log("üì¶ Data collected:",{images:l.images.length,colors:l.colors.length,typography:l.typography.length}),parent.postMessage({pluginMessage:{type:"generate-full-styleguide",images:l.images,palette:l.colors,typography:l.typography,config:u}},"*")})});</script>
  <style rel="stylesheet" crossorigin>:root{--bg: #FFFFFF;--surface: #F5F5F5;--text-main: #000;--text-sec: #8E8E8E;--border: #E0E0E0}html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden}*{box-sizing:border-box}body{font-family:Inter,sans-serif;background:var(--bg);color:var(--text-main);-webkit-font-smoothing:antialiased}#view-wrapper{width:100%;height:100vh;display:flex;flex-direction:column;position:relative}.view{position:absolute;inset:0;display:none!important;width:100%;height:100%;flex-direction:column}.view.active{display:flex!important}.view.centered{justify-content:center;align-items:center;padding:24px}.container{width:100%;max-width:720px;margin:0 auto;display:flex;flex-direction:column;align-items:center;text-align:center}.container.welcome{max-width:560px;width:100%;margin:auto}.title{display:flex;align-items:center;justify-content:center;gap:12px;font-size:22px;font-weight:600;margin-bottom:8px}.subtitle{font-size:14px;line-height:1.5;color:gray;margin-bottom:16px;max-width:480px}button{background:#000;color:#fff;border:0;border-radius:8px;font-size:14px;font-weight:600;padding:14px 24px;cursor:pointer;transition:opacity .2s;display:flex;align-items:center;justify-content:center;gap:8px}button:hover{opacity:.85}input[type=text]{width:100%;height:48px;border:1px solid #E6E6E6;border-radius:6px;padding:0 12px;font-size:14px}.row.code{display:flex;gap:8px;width:100%;max-width:440px}.row.code input{flex:1}.search-content{width:100%;max-width:450px;text-align:center}.input-row{display:flex;gap:8px;width:100%;margin-bottom:16px}.input-box{flex:1}.popular-row{display:flex;align-items:center;justify-content:center;gap:12px}.popular-label{font-size:11px;font-weight:600;color:#000000b3}.chips{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}.chip{padding:7px 17px;border-radius:20px;border:1px solid rgba(222,222,222,.6);font-size:11px;cursor:pointer;transition:background .2s}.chip:hover{background:#eee}.container.search-results{justify-content:flex-start;align-items:stretch;text-align:left;height:100%;padding:0;max-width:none}header{display:flex;justify-content:space-between;align-items:flex-end;padding:16px 24px;border-bottom:1px solid #e7e7e7;background:#fff;flex-shrink:0}.header-left{display:flex;align-items:center;gap:12px}.back-btn{width:32px;height:32px;border:1px solid #e7e7e7;border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer}.header-title{font-size:18px;font-weight:600;line-height:1.2}.tabs{display:flex;gap:16px;font-size:12px}.tab{cursor:pointer;padding-bottom:4px;color:#0006;font-weight:500}.tab.active{color:#000;font-weight:600;opacity:1}.grid-scroll{flex:1;overflow-y:auto;padding:24px 32px;position:relative}#moodboardGrid{display:block;column-count:3;column-gap:16px;width:100%;padding-bottom:120px;min-height:300px}.pin-container{display:inline-block;width:100%;margin-bottom:16px;border-radius:12px;background:var(--surface);overflow:hidden;break-inside:avoid;position:relative}.pin-image{display:block;width:100%;height:auto!important;min-height:100px;object-fit:cover;object-position:top;background-color:#e0e0e0}.pin-overlay{position:absolute;inset:0;background:#0000004d;display:flex;justify-content:center;align-items:center;opacity:0;transition:opacity .2s;cursor:pointer}.pin-container:hover .pin-overlay{opacity:1}.palette-header{display:flex;justify-content:space-between;align-items:center;padding:0 8px;margin-bottom:24px}.palette-title h3{text-align:left;margin:0;font-size:18px}.palette-title p{text-align:left;margin:4px 0 0;font-size:13px;color:var(--text-sec)}.palette-layout{display:flex;gap:24px;width:100%;padding:0 16px;align-items:flex-start}.palette-source{width:25%;min-width:140px;display:flex;flex-direction:column;gap:8px;position:sticky;top:0}.source-title{font-size:11px;font-weight:600;text-transform:uppercase;color:var(--text-sec);margin-bottom:4px}.source-thumbnails{display:grid;grid-template-columns:repeat(auto-fill,minmax(60px,1fr));gap:8px}.source-thumb{width:100%;aspect-ratio:1;object-fit:cover;border-radius:8px;border:1px solid var(--border);opacity:.9}.palette-result{width:75%;flex:1}.palette-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;width:100%;padding-bottom:120px}.role-card{background:#fff;border:1px solid var(--border);border-radius:10px;overflow:hidden;display:flex;flex-direction:column;cursor:pointer;transition:transform .1s}.role-card:hover{border-color:#000}.role-preview{height:70px;width:100%;display:flex;align-items:center;justify-content:center;position:relative}.contrast-dot{width:8px;height:8px;border-radius:50%;background:#fff;opacity:.4}.role-info{padding:10px;text-align:left}.role-name{font-size:11px;font-weight:600;text-transform:uppercase;color:var(--text-sec);margin-bottom:2px;display:block}.role-hex{font-size:14px;font-weight:600;color:var(--text-main);font-family:monospace}.role-primitive{font-size:10px;color:var(--text-sec);margin-top:4px;display:block;opacity:.6}.type-grid{display:flex;flex-direction:column;gap:32px;text-align:left;padding-bottom:120px;padding-left:16px;padding-right:16px}.font-pair-card{display:grid;grid-template-columns:1fr 1fr;gap:24px;border-bottom:1px solid var(--border);padding-bottom:24px;margin-bottom:24px}.font-preview-box{display:flex;flex-direction:column;gap:4px}.font-label{font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--text-sec);font-weight:600}.font-name{font-size:20px;font-weight:400;color:var(--text-main)}.scale-list{display:flex;flex-direction:column;gap:0}.scale-item{display:grid;grid-template-columns:100px 1fr;align-items:center;gap:16px;border-bottom:1px solid #f0f0f0;padding:16px 0}.scale-meta{display:flex;flex-direction:column;gap:2px;font-family:monospace;color:var(--text-sec)}.scale-role{font-size:11px;font-weight:600;color:var(--text-main);font-family:Inter,sans-serif;margin-bottom:2px}.scale-specs{font-size:9px;opacity:.7}.scale-preview{color:var(--text-main);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%}.dummy-content{padding:60px 24px;text-align:center;color:#8e8e8e;background:#fafafa;border-radius:12px;border:2px dashed #E0E0E0;margin-bottom:120px}.dummy-content h3{color:#000;font-size:18px;margin-bottom:8px}.bottom-bar{position:absolute;bottom:0;left:0;right:0;height:100px;background:linear-gradient(360deg,#fff,#fff0);display:flex;align-items:center;justify-content:center;pointer-events:none}.fab{pointer-events:auto;padding:14px 24px;border-radius:8px;background:#000;color:#fff;font-size:14px;font-weight:600;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:opacity .2s ease;border:none}.modal,.lightbox,.spinner-overlay{position:fixed;inset:0;background:#000c;display:none!important;justify-content:center;align-items:center;z-index:1000}.modal.active,.lightbox.active,.spinner-overlay.active{display:flex!important}.modal-content{background:#fff;padding:20px;border-radius:8px;max-width:280px;text-align:center}.modal-buttons{display:flex;gap:10px;justify-content:center;margin-top:15px}.spinner{border:4px solid rgba(255,255,255,.2);border-left-color:#fff;border-radius:50%;width:24px;height:24px;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.container.details{position:fixed;inset:0;z-index:2000;background:#000;padding:0;overflow:hidden;display:block;width:100%;height:100vh}.container.details .panel{width:100%;height:100%;overflow-y:auto;background:transparent;display:block;padding-bottom:0}#detailsImage{display:block;width:100%;height:auto;object-fit:contain;margin:0;padding:0}#detailsCloseBtn{position:fixed;top:20px;right:20px;padding:8px 12px;background:#fff;border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:9999;font-size:12px;font-weight:600}.container.details .bottom-bar{position:fixed;bottom:0;left:0;right:0;height:100px;background:linear-gradient(0deg,#000,#0000);display:flex;align-items:center;justify-content:center;gap:24px;z-index:9999;pointer-events:none}.container.details .circle-btn{pointer-events:auto;width:44px;height:44px;border-radius:50%;background:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform .1s}.container.details .circle-btn:active{transform:scale(.95)}.container.details .circle-btn.delete{width:64px;height:64px}.container.details .circle-btn svg{stroke:#000;stroke-width:2;width:24px;height:24px}.toast{position:fixed;bottom:-60px;left:50%;transform:translate(-50%);background-color:#28a745;color:#fff;padding:10px 20px;border-radius:8px;z-index:3000;transition:bottom .5s ease-in-out}.toast.show{bottom:30px}.toast.error{background-color:#dc3545}.drawer-backdrop{position:fixed;inset:0;background:#00000080;z-index:4000;display:none;opacity:0;transition:opacity .3s ease}.drawer-backdrop.active{display:block;opacity:1}.drawer{position:fixed;bottom:0;left:0;right:0;background:#fff;border-radius:16px 16px 0 0;box-shadow:0 -4px 24px #00000026;z-index:4001;transform:translateY(100%);transition:transform .3s ease;max-height:80vh;overflow-y:auto}.drawer.active{transform:translateY(0)}.drawer-header{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid var(--border);position:sticky;top:0;background:#fff;z-index:1}.drawer-title{font-size:18px;font-weight:600;color:var(--text-main)}.drawer-close{width:32px;height:32px;border-radius:8px;border:1px solid var(--border);display:flex;align-items:center;justify-content:center;cursor:pointer;background:transparent;transition:background .2s}.drawer-close:hover{background:var(--surface)}.drawer-content{padding:24px}.drawer-section{margin-bottom:32px}.drawer-section:last-child{margin-bottom:0}.drawer-section-title{font-size:14px;font-weight:600;color:var(--text-main);margin-bottom:16px}.drawer-option{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f5f5f5}.drawer-option:last-child{border-bottom:none}.drawer-option-label{display:flex;align-items:center;gap:8px;font-size:14px;color:var(--text-main)}.drawer-option-label.disabled{color:var(--text-sec);opacity:.6}.chip-soon{display:inline-block;padding:4px 10px;background:#f0f0f0;color:#666;font-size:10px;font-weight:600;text-transform:uppercase;border-radius:12px;letter-spacing:.5px}.toggle-switch{position:relative;width:44px;height:24px;flex-shrink:0}.toggle-switch input{opacity:0;width:0;height:0}.toggle-slider{position:absolute;cursor:pointer;inset:0;background-color:#ccc;border-radius:24px;transition:background-color .2s}.toggle-slider:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;border-radius:50%;transition:transform .2s}.toggle-switch input:checked+.toggle-slider{background-color:#000}.toggle-switch input:checked+.toggle-slider:before{transform:translate(20px)}.toggle-switch input:disabled+.toggle-slider{background-color:#e0e0e0;cursor:not-allowed;opacity:.5}.drawer-footer{padding:16px 24px;border-top:1px solid var(--border);background:#fff;position:sticky;bottom:0;display:flex;justify-content:flex-end}.drawer-footer button{width:auto}.container.loading{max-width:480px;width:100%;padding:40px 24px;align-items:flex-start;text-align:left}.loading-title{font-size:20px;font-weight:600;color:var(--text-main);margin:0 0 32px;text-align:left;padding-left:4px}.progress-list{display:flex;flex-direction:column;gap:16px;width:100%;text-align:left}.progress-item{display:flex;align-items:flex-start;gap:12px;opacity:.4;transition:opacity .3s ease}.progress-item.active{opacity:1}.progress-item.completed{opacity:.6}.progress-item .checkbox{font-family:monospace;font-size:18px;line-height:1.4;color:var(--text-sec);flex-shrink:0;transition:all .3s ease}.progress-item.completed .checkbox{color:var(--text-main)}.progress-item .text{font-size:14px;line-height:1.6;color:var(--text-main);flex:1}.container.search-agent{max-width:600px;width:100%;padding:0 24px;display:flex;flex-direction:column;align-items:center}.agent-title{font-size:22px;font-weight:600;text-align:center;margin-bottom:20px;color:#000;letter-spacing:-.02em}.agent-input-wrapper{position:relative;width:100%;max-width:480px}.agent-input{width:100%;height:130px;border-radius:24px;border:1px solid transparent;background:#f9f9f9;padding:24px 24px 80px;font-family:Inter,sans-serif;font-size:13px;line-height:1.5;color:#000;resize:none;outline:none;box-shadow:none;transition:all .2s ease}.agent-input:focus{border-color:#eaeaea;box-shadow:none}.agent-input::placeholder{color:#7d7d7d;font-size:13px}.agent-submit-btn{position:absolute;bottom:16px;right:16px;width:40px;height:40px;border-radius:50%;background:transparent;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform .2s ease;padding:0}.agent-submit-btn:hover{transform:scale(1.05);background:transparent}.agent-submit-btn:active{transform:scale(.95)}.search-terms-bar{background:#f9f9f9;padding:16px;margin:0 0 24px;border-radius:8px;display:flex;align-items:baseline;gap:6px;cursor:pointer;transition:background .2s ease;overflow:hidden;text-align:left}.search-terms-bar:hover{background:#f0f0f0}.results-label{font-size:13px;font-weight:600;color:#000;flex-shrink:0}.search-terms-text{font-size:13px;font-style:italic;color:#7d7d7d;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1}.search-terms-text strong{font-weight:600;font-style:italic}.container.generating{max-width:480px;width:100%;padding:40px 24px;text-align:center}.container.generating .spinner{display:inline-block;width:40px;height:40px;border:3px solid #f3f3f3;border-top:3px solid #000;border-radius:50%;animation:spin 1s linear infinite}.generating-message{font-size:13px;line-height:1.6;color:#7d7d7d;margin:0}</style>
</head>

<body>
    <div id="view-wrapper" class="view-wrapper">
        <!-- 1. WELCOME -->
        <div id="view-auth" class="view active centered">
            <div class="container welcome">
                <div class="title">
                    From mood board to style guide in no time!
                </div>
                <p class="subtitle">Viiibe pulls the right pins, shapes your mood board, and sets color, type, and
                    ready‚Äëto‚Äëuse Figma Variables & Styles.</p>
                <button type="button" id="connectButton" class="cta">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M12 24C10.8187 24 9.675 23.8219 8.59687 23.5031C9.05625 22.7812 9.55312 21.8531 9.80625 20.9344C9.95625 20.4 10.65 17.6344 10.65 17.6344C11.0625 18.4312 12.2812 19.125 13.5844 19.125C17.4469 19.125 20.0625 15.6094 20.0625 10.9031C20.0625 7.34063 17.0437 4.03125 12.4687 4.03125C6.76875 4.03125 3.89062 8.11875 3.89062 11.5312C3.89062 13.5937 4.66875 15.4313 6.34687 16.1156C6.61875 16.2281 6.8625 16.1156 6.94687 15.8156C7.00312 15.6094 7.13437 15.075 7.19062 14.85C7.275 14.55 7.2375 14.4469 7.02187 14.1844C6.54375 13.6125 6.23437 12.8813 6.23437 11.8313C6.23437 8.80313 8.50312 6.08438 12.1406 6.08438C15.3656 6.08438 17.1375 8.05313 17.1375 10.6781C17.1375 14.1375 15.6094 17.0531 13.3313 17.0531C12.075 17.0531 11.1375 16.0125 11.4375 14.7469C11.7937 13.2281 12.4969 11.5875 12.4969 10.4906C12.4969 9.50625 11.9719 8.69063 10.875 8.69063C9.59062 8.69063 8.55937 10.0219 8.55937 11.7938C8.55937 12.9281 8.94375 13.6875 8.94375 13.6875C8.94375 13.6875 7.63125 19.2562 7.39687 20.2219C7.18125 21.1312 7.15312 22.1438 7.19062 22.9781C2.95312 21.1406 0 16.9125 0 12C0 5.37187 5.37188 0 12 0C18.6281 0 24 5.37187 24 12C24 18.6281 18.6281 24 12 24Z"
                            fill="white" />
                    </svg>
                    Connect Pinterest
                </button>
            </div>
        </div>

        <!-- 2. AUTH -->
        <div id="view-authorization" class="view centered">
            <div class="container authorization">
                <h1>Connecting...</h1>
                <p class="subtitle">Check your browser to authorize Viiibe</p>
                <div class="spinner"
                    style="margin-top: 20px; border-color: #eee; border-left-color: #000; display: inline-block;"></div>
            </div>
        </div>

        <!-- 3. SEARCH -->
        <div id="view-search" class="view centered">
            <div class="container search-agent">
                <h1 class="agent-title">What will spark your creativity today?</h1>
                <div class="agent-input-wrapper">
                    <textarea id="searchInput" class="agent-input"
                        placeholder="Describe: &quot;modern red landing, big imagery, strong titles&quot;"></textarea>
                    <button id="createMoodboardButton" class="agent-submit-btn">
                        <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect width="40" height="40" rx="20" fill="black" />
                            <path d="M26 20L14 20M26 20L21 15.5M26 20L21 24.5" stroke="white" stroke-width="1.6"
                                stroke-linecap="round" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- 3.5 LOADING -->
        <div id="view-loading" class="view centered">
            <div class="container loading">
                <h2 class="loading-title">Creating your mood board</h2>
                <div class="progress-list">
                    <div class="progress-item" data-step="1">
                        <span class="checkbox">‚òê</span>
                        <span class="text">Getting the creative spark you're chasing</span>
                    </div>
                    <div class="progress-item" data-step="2">
                        <span class="checkbox">‚òê</span>
                        <span class="text">Roaming across Pinterest for the good stuff</span>
                    </div>
                    <div class="progress-item" data-step="3">
                        <span class="checkbox">‚òê</span>
                        <span class="text">Giving shape to your Viiibe board</span>
                    </div>
                    <div class="progress-item" data-step="4">
                        <span class="checkbox">‚òê</span>
                        <span class="text">Blending colors and pixels that click</span>
                    </div>
                    <div class="progress-item" data-step="5">
                        <span class="checkbox">‚òê</span>
                        <span class="text">Laying out text styles that read beautifully</span>
                    </div>
                    <div class="progress-item" data-step="6">
                        <span class="checkbox">‚òê</span>
                        <span class="text">Selecting the patterns that truly fit</span>
                    </div>
                    <div class="progress-item" data-step="7">
                        <span class="checkbox">‚òê</span>
                        <span class="text">Ready to go: review and polish your Viiibe board</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3.6 GENERATING STYLE GUIDE -->
        <div id="view-generating" class="view centered">
            <div class="container generating">
                <div class="spinner" style="margin-bottom: 24px;"></div>
                <p class="generating-message">Putting it all together: color palette, type scale, and a beautiful Viiibe
                    board...</p>
            </div>
        </div>

        <!-- 4. RESULTS -->
        <div id="view-moodboard" class="view">
            <div class="container search-results">
                <header>
                    <div class="header-left">
                        <div id="backButton" class="back-btn" title="Back">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M14.1377 12.3198L10.6963 15.7612H23.0889V16.7612H10.6973L14.1377 20.2017L13.4307 20.9087L8.7832 16.2612L9.13672 15.9077L13.4307 11.6128L14.1377 12.3198Z"
                                    fill="black" />
                            </svg>
                        </div>
                        <div class="header-text">
                            <div class="header-title">Results</div>
                        </div>
                    </div>
                    <div class="tabs">
                        <div id="tab-moodboard" class="tab active">Mood board</div>
                        <div id="tab-colors" class="tab">Color palette</div>
                        <div id="tab-typography" class="tab">Type scale</div>
                        <div id="tab-layout" class="tab">Layout</div>
                    </div>
                </header>

                <div class="grid-scroll">
                    <div id="searchTermsBar" class="search-terms-bar">
                        <span class="results-label">Results for:</span>
                        <span id="searchTermsDisplay" class="search-terms-text"></span>
                    </div>
                    <div id="moodboardGrid"></div>

                    <!-- Color Palette -->
                    <div id="section-colors" class="section-container" style="display: none;">
                        <div class="palette-header">
                            <div class="palette-title">
                                <h3>System Colors</h3>
                                <p>Semantic roles generated from moodboard.</p>
                            </div>
                        </div>
                        <div class="palette-layout">
                            <div class="palette-source"><span class="source-title">Source Inspiration</span>
                                <div id="sourceImagesGrid" class="source-thumbnails"></div>
                            </div>
                            <div class="palette-result">
                                <div id="paletteGrid" class="palette-grid">
                                    <p style="grid-column:1/-1; text-align:center; color:#999; margin-top:20px;">
                                        Analyzing pixels...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Typography -->
                    <div id="section-typography" class="section-container" style="display: none;">
                        <div class="palette-header" style="margin-bottom: 24px; padding: 0 16px;">
                            <div class="palette-title">
                                <h3 style="margin:0; font-size:18px;">Type Scale</h3>
                                <p style="line-height: 1.5; margin: 4px 0 0 0; color: #8E8E8E; font-size: 13px;">Based
                                    on your moodboard vibe, we suggest a <strong>functional pairing</strong> to start
                                    your system.<br><span style="opacity: 0.7; font-size: 12px;">(Note: We can't detect
                                        exact fonts from images yet, so we provide a solid match for the style).</span>
                                </p>
                            </div>
                        </div>
                        <div id="typographyContent" class="type-grid">
                            <p style="text-align:center; color:#999;">Analyzing style...</p>
                        </div>
                    </div>

                    <!-- Layouts -->
                    <div id="section-layout" class="dummy-content" style="display: none;">
                        <h3>Layouts</h3>
                        <p>Features coming soon...</p>
                    </div>
                </div>

                <div class="bottom-bar">
                    <div class="fab">
                        Generate style guide
                    </div>
                </div>
            </div>
        </div>

        <!-- 5. DETAILS -->
        <div id="view-details" class="view">
            <div class="container details">
                <div class="panel">
                    <div id="detailsCloseBtn" class="chip-close">Close</div>
                    <img id="detailsImage" class="details-image" alt="Preview" />
                    <div class="bottom-bar">
                        <div id="detailsPrevBtn" class="circle-btn"><svg fill="none" viewBox="0 0 24 24">
                                <path d="M15 18L9 12L15 6" stroke="black" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg></div>
                        <div id="detailsDeleteBtn" class="circle-btn delete"><svg fill="none" viewBox="0 0 24 24">
                                <path
                                    d="M4 7H20M9 3H15M10 11V17M14 11V17M6 7L7 19C7 20.1046 7.89543 21 9 21H15C16.1046 21 17 20.1046 17 19L18 7"
                                    stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg></div>
                        <div id="detailsNextBtn" class="circle-btn"><svg fill="none" viewBox="0 0 24 24">
                                <path d="M9 6L15 12L9 18" stroke="black" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- UTILS -->
        <div id="lightbox" class="lightbox">
            <div id="spinnerOverlay" class="spinner-overlay">
                <div class="spinner"></div>
            </div>
            <span id="lightboxClose" class="lightbox-close">&times;</span>
            <button id="lightboxPrev" class="lightbox-nav prev">&lt;</button>
            <img id="lightboxImage" class="lightbox-content">
            <button id="lightboxNext" class="lightbox-nav next">&gt;</button>
            <div class="lightbox-actions"><button id="lightboxDeleteButton" class="danger">Eliminar</button></div>
        </div>
        <div id="confirmModal" class="modal">
            <div class="modal-content">
                <p><strong>¬øQuitar esta imagen del moodboard?</strong></p>
                <div class="modal-buttons"><button id="cancelDeleteButton" class="secondary">Cancelar</button><button
                        id="confirmDeleteButton" class="danger">Quitar</button></div>
            </div>
        </div>
        <div id="toast" class="toast"></div>

        <!-- DRAWER -->
        <div id="drawerBackdrop" class="drawer-backdrop"></div>
        <div id="styleGuideDrawer" class="drawer">
            <div class="drawer-header">
                <div class="drawer-title">Style guide set</div>
                <div id="drawerCloseBtn" class="drawer-close">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 4L4 12M4 4L12 12" stroke="black" stroke-width="2" stroke-linecap="round" />
                    </svg>
                </div>
            </div>
            <div class="drawer-content">
                <!-- Basic Download Section -->
                <div class="drawer-section">
                    <div class="drawer-section-title">Basic download</div>
                    <div class="drawer-option">
                        <div class="drawer-option-label">Download mood board</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="toggle-moodboard" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="drawer-option">
                        <div class="drawer-option-label">Download color palette</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="toggle-palette" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="drawer-option">
                        <div class="drawer-option-label">Download type scale</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="toggle-typography" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Advanced Download Section -->
                <div class="drawer-section">
                    <div class="drawer-section-title">Advanced download</div>
                    <div class="drawer-option">
                        <div class="drawer-option-label">Create Figma styles</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="toggle-styles">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="drawer-option">
                        <div class="drawer-option-label">Create Figma variables</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="toggle-variables">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="drawer-option">
                        <div class="drawer-option-label disabled">
                            Create basic components
                            <span class="chip-soon">Soon</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="toggle-components" disabled>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="drawer-footer">
                <button id="generateStyleGuideBtn">Get style guide</button>
            </div>
        </div>
    </div>
</body>

</html>